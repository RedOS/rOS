Data={["version"]="1.0",["name"]="Multitask",}

Processes={}
parentTerm = term.current()

function launch(tEnv,sProgramPath,sTitle,...)
    local ProgramArgs={...}
    local nProcess=#Processes+1
    local Process={}
    Process.title=sTitle or fs.getName(sProgramPath)
	Process.path=fs.getDir(sProgramPath)
	Process.aPath=sProgramPath
    Process.window=window.create(parentTerm,1,2,Screen.Width,Screen.Height,true)
    Process.co = coroutine.create( function()
        os.run(tEnv,sProgramPath,unpack(ProgramArgs))
    end )
	Processes[nProcess]=Process
	select(nProcess)
    return nProcess
end

function setTitle(nProcess,title)
	if Processes[nProcess] then
		Processes[nProcess].title=title
	end
end

function select(nProcess)
	if Processes[nProcess] then
		term.redirect(Processes[nProcess].window)
		Processes[nProcess].window.redraw()
		Multitask.selected=nProcess
		coroutine.resume(Processes[nProcess].co)
	end
end

function close(nProcess)
	if Processes[nProcess] then
		table.remove(Processes,nProcess)
		select(1)
		return true
	else
		return false
	end
end