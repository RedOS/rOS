Data={["version"]="1.0",["name"]="Draw",}

BgColor=32768
TextColor=1
isVisible=true
sColor=1
statusTime="center"
Cursor={1,1}

function isStatusVisible(bool)
if bool==true then Draw.isVisible=true else Draw.isVisible=false end
end

function setStatusColor(nColor)
Draw.sColor=nColor
end
oterm={}
oterm.setBackgroundColor=term.setBackgroundColor
oterm.setTextColor=term.setTextColor
function term.setBackgroundColor(nColor)
oterm.setBackgroundColor(nColor)
Draw.BgColor=nColor
end
function term.setTextColor(nColor)
oterm.setTextColor(nColor)
Draw.TextColor=nColor
end


function status()
	local _term=term.current()
	term.redirect(Core.parentTerm)
	local _bClr=Draw.BgColor
	local _tClr=Draw.TextColor
	if Draw.isVisible then
	ox,oy=term.getCursorPos()
	local Data=Core.getData()
	Data.Time=string.format("  %02d:%02d %s",Time.get(os.time(),Data.H24))
	if Draw.statusTime~="right" then 
	paintutils.drawLine(1,1,Screen.Width,1,Draw.sColor)
	end
	term.setTextColor(Draw.sColor==1 and 32768 or 1)
	if Draw.statusTime=="right" then
	term.setCursorPos((Screen.Width-#Data.Time+1),1)
	elseif Draw.statusTime=="left" then
	term.setCursorPos(2,1)
	else
	term.setCursorPos((Screen.Width-3-#Data.Time/2)/2,1)
	end
	write(Data.Time)
	if Draw.statusTime~="right" then
	term.setCursorPos(Screen.Width-((Data.bModem and 2 or 0) + (Data.Notification and 2 or 0)) +2,1)
	write((Data.bModem and "M " or "")..(Data.Notification and "N " or ""))
	end
	term.setCursorPos(ox,oy)
	term.setBackgroundColor(_bClr)
	term.setTextColor(_tClr)
	end
	term.redirect(_term)
end

function clear(color)
	local color=color or Draw.BgColor
	term.setBackgroundColor(color)
	term.clear()
	term.setCursorPos(1,1)
end

function clearLine()
	x,y=Draw.getCursor()
end

function loadIcon(path,bBig)
if fs.exists(path) then
f=fs.open(path,"r")
data=f.readAll()
text=textutils.unserialize(data)
if text then
if bBig then if text.big then text=text.big end elseif text.icon then text=text.icon end
end
f.close()
return text or nil
end
end
function cCode(h)
        if term.isColor() and term.isColor then
                return 2 ^ (tonumber(h, 16) or 0)
        else
                if h == "f" then
                        return colors.black
                else
                        return colors.white
                end
        end
end
function cwrite(text)
        text = tostring(text)
        local i = 0
        while true  do
                i = i + 1
                if i > #text then break end
                
                local c = text:sub(i, i)

                if c == "\\" then
                        if text:sub(i+1, i+1) == "&" then
                                write("&")
                                i = i + 1
                        elseif text:sub(i+1, i+1) == "$" then
                                write("$")
                                i = i + 1
                        else
                                write(c)
                        end
                elseif c == "&" then
                        term.setTextColor(cCode(text:sub(i+1, i+1)))
                        i = i + 1
                elseif c == "$" then
                        term.setBackgroundColor(cCode(text:sub(i+1, i+1)))
                        i = i + 1
                else
                        write(c)
                end
        end
        return
end
function cprint(text)
cwrite(text.."\n")
end
function icon(text,x,y)
if text then
for i=1,#text do
term.setCursorPos(x,y+(i-1))
cwrite(text[i])
end
end
end